/*
TED演讲 如何激励你的孩子
文章来源：未知 文章作者：enread 发布时间：2020-04-14 05:46 字体： [大 中 小]　 进入论坛
(单词翻译:双击或拖选)
Jennifer Nacif: The Secret to Motivating Your Child

Jennifer Nacif讲解了如何在与孩子们沟通时，将控制转换为激励。她在演讲中扮演了四个性格各不相同的孩子，展示了不同性格需求父母不同的反应。在生活中，不仅孩子们与性格需求相关，所遇到的人都有性格需求。还介绍了简单可行的方式以激励我们周围的人们。

英文讲稿：
I'm so excited!
 
Well, I'm excited not only to be in TEDxSanDiego, but to touch on my favorite subject: the secret to motivating your children. I mean we try to motivate, we do our best, but generally what do we do? We use fear: "Ah, if you don't do this, mmm, big punishment." Or we bribe1 them: "OK, if you do this, you'll get this prize, or this payment2."
 
And, well it works3, on the short term. But there are ramifications4, consequences that we're not aware of in the long run, when we educate in this manner.
 
So, today I want to ask you a question: How many of you would love to have a better relationship with your children? Raise your hands. Everyone, of course!
 
Now, a harder question: How many of you believe you know, exactly, how to motivate your children? Don't worry, don't feel bad, I don't see any hands. Don't take it personally.
 
My studies – I've been studying this for more than 20 years – are that less than 2% of parents have the exact answer to this question. The good news is: all of you, by the end of this talk, are going to know, exactly, in one word, how to motivate your children.
 
So, let me start by telling you a real story. I live in Mexico City and we were at a party, it was a girl's 10th birthday; my friend has four daughters and they were behaving, not [badly], no, [terribly]! It came to a point that my friend was very tired and went to the four girls: "The four of you come here, either you behave well or we're going to leave." Oh, and let me mention, in Mexico the best part of a party is the pinata, the famous pinata (a figure filled with goodies). No kid wants to leave before the pinata.
 
So the first daughter stares at her mom and says: "Mom, you're right. I've been telling my sisters to behave, but they don't pay attention, what can I do?" So the mom goes: "Good job, I'm doing well."
 
The second daughter looks at the mom… (She sobs) "I'm so sorry mom, I hate disappointing you, but see, if I don't do what my sisters say then they think I'm a goody goody, and I always follow you, and then they don't like me."
 
But I didn't want you to not like me either. (Sobs) Total depression. She goes to a corner, depressed5. She needs therapy6, probably, after that.
 
The third daughter stares at her mom: "My mom, beautiful, wonderful ‘preciosa mamita'. You keep enjoying what you're doing, of course I'm going to behave. I'm having a wonderful time." She waits five minutes and guess what she does? She goes back to doing what she was doing.
 
And then, the last daughter stares at her mom and she says: "Oh really? Then we leave right now!"
 
What happened? Same household, same education, [they were raised in the same place]. Why did they react so differently? You might all say, "Obvious, they're different." So if it is so obvious, why do we so often give one instruction to different people expecting the same outcome7? That's what we're going to talk about today.
 
So, what I did is that, all the way from Mexico city, I brought the four girls. And they are going to tell you a bit about themselves, and the most important part: what motivates each one of them in several words and in one word. So let me introduce you to the first daughter. Oh, these are mine by the way. Let me introduce you to the first daughter. Her name is Donna because she's so dominant8.
 
Hi, I'm a controlling child, yes I am. I know it and I don't care. I like things done, not fast, super fast. I'm very independent, I like things fast, direct, I have a lot of willpower. I mean, since I was a baby, you know, if I was going maybe 4 hours drive, I didn't like the car seat, so I would cry. And I wouldn't stop crying, 'til the 4 hours were over. I mean, I get what I want. I don't ask for it, I demand it. I mean, that's how life should be, no? Let's get what we want, let's insist on it. I'm adventurous9, I'm powerful. So, what do you think motivates me? OK, challenges? I love being right. I know they say that it's more important to be happy. I don't know who says that. I mean come on! Being right is super more important than being happy. Winning and control, very important. But if you can only remember one word, remember this: I need power. I like to feel powerful. So the next time you're communicating with me, if you take away my power, you bring out the worst in me. So If I'm at a party and my mom says, ‘if you behave badly, I'm going to take you away. Oh really? We'll see, we'll see who wins."
 
So, the question here is: what should the mother have said? Well, the answer, before creating things, is ask yourselves: what motivates my D daughter? Power. So, why don't I tell Donna: "Hey Donna, I need to ask for a favour. See, your sisters follow you. I wish they would follow me more, and I need your help. I know I'm asking a lot because you're just 10 years old. And what I'm asking you to do, well, generally, we ask adults. So I hope you can do this. Can you help me set an example for your sisters? Can you do that?" What? D is going to resist that? I mean that's gold to my ears. So we get the first good outcome.
 
And now I want to introduce you to Sally. Before introducing you to Sally, this is my D daughter. So this is how I've become an expert on the subject.
 
Hello, I am Sally the social girl. I'm a happy kid, I love fun, I love doing happy things, and connecting with people, talking to people, knowing people. Is there anything else in life than knowing a lot of friends, and having a lot of friends? So to me, helping10 others and having a great old time is wonderful. At the party you must ask yourselves what motivates us? OK, so as social people, we need to connect with people, to make friends, to help] others. Our keywords are: connection and fun. My mother could have just come and said, how about if she would have said: ‘Hey look at all those trees, don't they make amazing hiding places? Why don't you organize a great hide and seek game?' You think I'm going to resist that? You think I'm going to want to go back to do what I was doing, when I can do a hide and seek game? See how it flows, how naturally it comes, when we are motivated to do what we were born to do? So that's our social girl. And let me introduce you to Vivi, my social sister. She has given me the experience to deal with social people. If you're hearing a laugh, it's my mom.
 
Third, I want to introduce you to Patty.
 
Good afternoon. My name is Patty. I love helping, stability11, my family. I love being close to my family. I miss them when I'm away. I don't like pressure, I hate confrontation12. I really stress out with that. I like for people to get along, to love each other, to share, to care. What motivates me the most? Harmony, safety, kindness, acceptance13, helping others. A key word for me: safety. If I feel safe, I'll go to the end of the world, But If I feel threatened, well, I don't do much at all. I can freeze even. So, what should have my mom said to me? She could've approached me and in a very loving and caring way said: ‘Patty, I know you want to please your sisters, I understand. And I know you feel bad because you want to please me, but remember, life is not about pleasing others. I know deep down in your heart you know what's right. Trust your heart, not people outside of you, but yourself. No matter what happens, I'm always here and I love you.' (She takes a deep breath) That felt so good. So let's remember, if you have kids like me, always through patience, love, and understanding. No pressure please. We don't do well. Thank you."
 
And, this is my beautiful Valentina. She's my Patty daughter who has taught me about the kindness and wonderful human heart of that style of personality. Last but not least:
 
Hi, My name is Anna. I am a very responsible child ever since I was born, I do what I am suppose to; I follow rules, that's why they exist, I wish everyone would. I'm very ordered, I organize my things wonderfully well. So, I'm a very good child. I have good grades. Hey, so, you could almost say we're the perfect children. The problem is we need to lighten14 up sometimes because we take so much responsibility and so much so seriously, that we always have stomach problems. When we grow up, if you know people like me, we have gastroenteritis and a lot of other stomach things. We are just way too apprehensive15. So what motivates us: order, structure, mental challenges. Key word: clarity16. Step by step, specific instructions and you will get the best of us.
 
And from the daughters, Anna was the one who reacted in the best way because she said, I know mom." So we could give her instructions on how she could help her sisters do better things.
 
So, in conclusion... Oh, and let me introduce you to Vane, my analytical17 sister who, when I grew up, helped me understand the importance of cleanliness, that's next to heavenliness right?
 
So, just to conclude, I hope that you remember, when you talk to your children, what motivates them. Is it power? Is it connection and fun? Is it safety? Is it clarity? Be it what it may be, I invite you to create a chain reaction for all parents to change manipulation18 to motivation. Thank you.


京XXXX喜签到

============Quantumultx===============
[task_local]
#京喜签到
5 0 * * * https://gitee.com/lxk0301/jd_scripts/raw/master/jx_sign.js, tag=京喜签到, img-url=https://raw.githubusercontent.com/Orz-3/task/master/jd.png, enabled=true

================Loon==============
[Script]
cron "5 0 * * *" script-path=https://gitee.com/lxk0301/jd_scripts/raw/master/jx_sign.js,tag=京喜签到

===============Surge=================
京喜签到 = type=cron,cronexp="5 0 * * *",wake-system=1,timeout=3600,script-path=https://gitee.com/lxk0301/jd_scripts/raw/master/jx_sign.js

============小火箭=========
京喜签到 = type=cron,script-path=https://gitee.com/lxk0301/jd_scripts/raw/master/jx_sign.js, cronexpr="5 0 * * *", timeout=3600, enable=true
 */
const $ = new Env('京喜签到');
const notify = $.isNode() ? require('./sendNotify') : '';
//Node.js用户请在jdCookie.js处填写京东ck;
const jdCookieNode = $.isNode() ? require('./jdCookie.js') : '';
let jdNotify = true;//是否关闭通知，false打开通知推送，true关闭通知推送
//IOS等用户直接用NobyDa的jd cookie
let cookiesArr = [], cookie = '', message;
let helpAuthor = true
if ($.isNode()) {
  Object.keys(jdCookieNode).forEach((item) => {
    cookiesArr.push(jdCookieNode[item])
  })
  if (process.env.JD_DEBUG && process.env.JD_DEBUG === 'false') console.log = () => {};
} else {
  let cookiesData = $.getdata('CookiesJD') || "[]";
  cookiesData = jsonParse(cookiesData);
  cookiesArr = cookiesData.map(item => item.cookie);
  cookiesArr.reverse();
  cookiesArr.push(...[$.getdata('CookieJD2'), $.getdata('CookieJD')]);
  cookiesArr.reverse();
  cookiesArr = cookiesArr.filter(item => item !== "" && item !== null && item !== undefined);
}
const JD_API_HOST = 'https://m.jingxi.com/';
!(async () => {
  if (!cookiesArr[0]) {
    $.msg($.name, '【提示】请先获取京东账号一cookie\n直接使用NobyDa的京东签到获取', 'https://bean.m.jd.com/bean/signIndex.action', {"open-url": "https://bean.m.jd.com/bean/signIndex.action"});
    return;
  }
  $.newShareCodes = []
  // await getAuthorShareCode();
  for (let i = 0; i < cookiesArr.length; i++) {
    if (cookiesArr[i]) {
      cookie = cookiesArr[i];
      $.UserName = decodeURIComponent(cookie.match(/pt_pin=(.+?);/) && cookie.match(/pt_pin=(.+?);/)[1])
      $.index = i + 1;
      $.isLogin = true;
      $.nickName = '';
      message = '';
      await TotalBean();
      console.log(`\n******开始【京东账号${$.index}】${$.nickName || $.UserName}*********\n`);
      if (!$.isLogin) {
        $.msg($.name, `【提示】cookie已失效`, `京东账号${$.index} ${$.nickName || $.UserName}\n请重新登录获取\nhttps://bean.m.jd.com/bean/signIndex.action`, {"open-url": "https://bean.m.jd.com/bean/signIndex.action"});

        if ($.isNode()) {
          await notify.sendNotify(`${$.name}cookie已失效 - ${$.UserName}`, `京东账号${$.index} ${$.UserName}\n请重新登录获取cookie`);
        }
        continue
      }
      await jdCash()
    }
  }
})()
    .catch((e) => {
      $.log('', `❌ ${$.name}, 失败! 原因: ${e}!`, '')
    })
    .finally(() => {
      $.done();
    })
async function jdCash() {
  $.coins = 0
  $.money = 0
  await sign()
  await getTaskList()
  await doubleSign()
  await showMsg()
}
function sign() {
  return new Promise((resolve) => {
    $.get(taskUrl("pgcenter/sign/UserSignOpr"), async (err, resp, data) => {
      try {
        if (err) {
          console.log(`${JSON.stringify(err)}`)
          console.log(`${$.name} API请求失败，请检查网路重试`)
        } else {
          if (safeGet(data)) {
            data = JSON.parse(data);
            if(data.retCode ===0){
              if(data.data.signStatus===0){
                console.log(`签到成功，获得${data.data.pingoujin}金币，已签到${data.data.signDays}天`)
                $.coins += parseInt(data.data.pingoujin)
              }else{
                console.log(`今日已签到`)
              }
            }else{
              console.log(`签到失败，错误信息${data.errMsg}`)
            }
          }
        }
      } catch (e) {
        $.logErr(e, resp)
      } finally {
        resolve(data);
      }
    })
  })
}
function getTaskList() {
  return new Promise((resolve) => {
    $.get(taskUrl("pgcenter/task/QueryPgTaskCfgByType","taskType=3"), async (err, resp, data) => {
      try {
        if (err) {
          console.log(`${JSON.stringify(err)}`)
          console.log(`${$.name} API请求失败，请检查网路重试`)
        } else {
          if (safeGet(data)) {
            data = JSON.parse(data);
            if(data.retCode ===0){
              for (task of data.data.tasks) {
                if(task.taskState===1){
                  console.log(`去做${task.taskName}任务`)
                  await doTask(task.taskId);
                  await $.wait(1000)
                  await finishTask(task.taskId);
                  await $.wait(1000)
                }
              }
            }else{
              console.log(`签到失败，错误信息${data.errMsg}`)
            }
          }
        }
      } catch (e) {
        $.logErr(e, resp)
      } finally {
        resolve(data);
      }
    })
  })
}
function doTask(id) {
  return new Promise((resolve) => {
    $.get(taskUrl("pgcenter/task/drawUserTask",`taskid=${id}`), async (err, resp, data) => {
      try {
        if (err) {
          console.log(`${JSON.stringify(err)}`)
          console.log(`${$.name} API请求失败，请检查网路重试`)
        } else {
          if (safeGet(data)) {
            data = JSON.parse(data);
            if(data.retCode ===0){
              console.log(`任务领取成功`)
            }else{
              console.log(`任务完成失败，错误信息${data.errMsg}`)
            }
          }
        }
      } catch (e) {
        $.logErr(e, resp)
      } finally {
        resolve(data);
      }
    })
  })
}
function finishTask(id) {
  return new Promise((resolve) => {
    $.get(taskUrl("pgcenter/task/UserTaskFinish",`taskid=${id}`), async (err, resp, data) => {
      try {
        if (err) {
          console.log(`${JSON.stringify(err)}`)
          console.log(`${$.name} API请求失败，请检查网路重试`)
        } else {
          if (safeGet(data)) {
            data = JSON.parse(data);
            if(data.retCode ===0){
              console.log(`任务完成成功，获得金币${data.datas[0]['pingouJin']}`)
              $.coins += data.datas[0]['pingouJin']
            }else{
              console.log(`任务完成失败，错误信息${data.errMsg}`)
            }
          }
        }
      } catch (e) {
        $.logErr(e, resp)
      } finally {
        resolve(data);
      }
    })
  })
}
function doubleSign() {
  return new Promise((resolve) => {
    $.get(taskUrl("double_sign/IssueReward",), async (err, resp, data) => {
      try {
        if (err) {
          console.log(`${JSON.stringify(err)}`)
          console.log(`${$.name} API请求失败，请检查网路重试`)
        } else {
          if (safeGet(data)) {
            data = JSON.parse(data);
            if(data.retCode ===0){
              console.log(`双签成功，获得金币${data.data.jd_amount / 100}元`)
              $.money += data.data.jd_amount / 100
            }else{
              console.log(`任务完成失败，错误信息${data.errMsg}`)
            }
          }
        }
      } catch (e) {
        $.logErr(e, resp)
      } finally {
        resolve(data);
      }
    })
  })
}
function showMsg() {
  message+=`本次运行获得金币${$.coins},现金${$.money}`
  return new Promise(resolve => {
    if (!jdNotify) {
      $.msg($.name, '', `${message}`);
    } else {
      $.log(`京东账号${$.index}${$.nickName}\n${message}`);
    }
    resolve()
  })
}

function taskUrl(functionId, body = '') {
  return {
    url: `${JD_API_HOST}${functionId}?sceneval=2&g_login_type=1&g_ty=ls&${body}`,
    headers: {
      'Cookie': cookie,
      'Host': 'm.jingxi.com',
      'Connection': 'keep-alive',
      'Content-Type': 'application/x-www-form-urlencoded',
      'Referer': 'https://jddx.jd.com/m/jddnew/money/index.html',
      'User-Agent': $.isNode() ? (process.env.JD_USER_AGENT ? process.env.JD_USER_AGENT : (require('./USER_AGENTS').USER_AGENT)) : ($.getdata('JDUA') ? $.getdata('JDUA') : "jdapp;iPhone;9.2.2;14.2;%E4%BA%AC%E4%B8%9C/9.2.2 CFNetwork/1206 Darwin/20.1.0"),
      'Accept-Language': 'zh-cn',
      'Accept-Encoding': 'gzip, deflate, br',
    }
  }
}

function TotalBean() {
  return new Promise(async resolve => {
    const options = {
      "url": `https://wq.jd.com/user/info/QueryJDUserInfo?sceneval=2`,
      "headers": {
        "Accept": "application/json,text/plain, */*",
        "Content-Type": "application/x-www-form-urlencoded",
        "Accept-Encoding": "gzip, deflate, br",
        "Accept-Language": "zh-cn",
        "Connection": "keep-alive",
        "Cookie": cookie,
        "Referer": "https://wqs.jd.com/my/jingdou/my.shtml?sceneval=2",
        "User-Agent": $.isNode() ? (process.env.JD_USER_AGENT ? process.env.JD_USER_AGENT : (require('./USER_AGENTS').USER_AGENT)) : ($.getdata('JDUA') ? $.getdata('JDUA') : "jdapp;iPhone;9.2.2;14.2;%E4%BA%AC%E4%B8%9C/9.2.2 CFNetwork/1206 Darwin/20.1.0")
      }
    }
    $.post(options, (err, resp, data) => {
      try {
        if (err) {
          console.log(`${JSON.stringify(err)}`)
          console.log(`${$.name} API请求失败，请检查网路重试`)
        } else {
          if (data) {
            data = JSON.parse(data);
            if (data['retcode'] === 13) {
              $.isLogin = false; //cookie过期
              return
            }
            $.nickName = data['base'].nickname;
          } else {
            console.log(`京东服务器返回空数据`)
          }
        }
      } catch (e) {
        $.logErr(e, resp)
      } finally {
        resolve();
      }
    })
  })
}
function safeGet(data) {
  try {
    if (typeof JSON.parse(data) == "object") {
      return true;
    }
  } catch (e) {
    console.log(e);
    console.log(`京东服务器访问数据为空，请检查自身设备网络情况`);
    return false;
  }
}
function jsonParse(str) {
  if (typeof str == "string") {
    try {
      return JSON.parse(str);
    } catch (e) {
      console.log(e);
      $.msg($.name, '', '请勿随意在BoxJs输入框修改内容\n建议通过脚本去获取cookie')
      return [];
    }
  }
}
// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
