/*

米歇尔·奥巴马在白宫发表最后一次演讲
文章来源：未知 文章作者：enread 发布时间：2020-03-24 06:50 字体： [大 中 小]　 进入论坛
(单词翻译:双击或拖选)
Hey! What's going on? Thank you all so much. You guys, that's a command — rest yourselves. We're almost at the end.
嘿！你们怎么啦？非常感谢你们！伙计们，我命令你们休息一下。我们就快要结束了。
Hello, everyone. And, may I say for the last time officially, welcome to the White House.
大家好，请允许我最后一次官方地说，欢迎来到白宫。
Yes! Well, we are beyond thrilled to have you all here to celebrate the 2017 National School Counselor1 of the Year, as well as all of our State Counselors2 of the Year.
是的，那么，我们非常激动地邀请各位一起对2017年度学校顾问和各位教育顾问们进行表彰。
These are the fine women, and a few good men — one good man — who are on this stage, and they represent schools from across this country.
他们都是好女人和几个好男人——一个好男人——他们站在台上，代表着我们国家的各个学校。
And I want to start by thanking Terri for that wonderful introduction and her right-on-the-spot remarks.
我想首先感谢Terri——她精彩的介绍以及她刚刚在现场的一番话。
I'm going to say a lot more about Terri in a few minutes, but first I want to take a moment to acknowledge a few people who are here.
我会在接下来的几分钟内谈到更过关于Terri的事，但首先我想花一点时间来答谢在这里的一些人。
First, our outstanding Secretary of Education, John King.
首先是我们杰出的教育部长，John King。
As well as our former Education Secretary, Arne Duncan.
以及我们前任的教育部长Arne Duncan。
I want to take this time to thank you both publicly for your dedication4 and leadership and friendship.
我想要借这个时间公开地感谢你们两位——你的奉献和领导以及友谊。
We couldn't do this without the support of the Department of Education under both of your leadership.
如果没有你们领导下的教育部的支持，我们是无法做到的。
So I'm grateful to you personally, and very proud of all that you've done for this country.
所以我非常感谢你们，同时我也对你们为这个国家所做的所有事感到自豪。
I also want to acknowledge a few other special guests we have in the audience. We've got a pretty awesome5 crew.
我还想答谢一下一些在观众席中、我们其他特别的嘉宾。我们有一支非常棒的团队，
You know, as one of my staff said, "You roll pretty deep."
你知道，正如我的一个工作人员说，你们都相当熟了。
I'm like, well, yeah, we have a few good friends.
是的，我们有一些很棒的朋友。
We have with us today Ted6 Allen, La La Anthony, Connie Britton, Andy Cohen — yeah, Andy Cohen is here,
今天在这里，和我们在一起的有Ted Allen, ala Anthony, Connie Britton, Andy Cohen。是的，AndyCohen在这里。
Carla Hall, Coach Jim Harbaugh and his beautiful wife, who's a lot better looking than him— Lana Parrilla, my buddy7 Jay Pharoah, Kelly Rowland, Usher8
Carla Hall, Coach Jim Harbaugh，以及比他好看很多的，他美丽的妻子LanaParrilla，我的伙伴Jay Pharoah, Kelly Rowland, Usher.
Woo! Keep it down. Keep it together, ladies. Wale is here.
喔。保持，保持低调，保持冷静。Wale在这里。
And of course, Allison Williams and her mom are here.
当然了，Allison Williams和她的母亲也在这。
And all these folks are here because they're using their star power to inspire our young people.
所有这些人都在这里，因为他们使用他们的明星般的魅力来鼓舞我们的年轻人。
And I'm so grateful to all of you for stepping up in so many ways on so many occasions.
我非常感谢大家都在许多方面、许多场合不断加强自己，
I feel like I've pestered9 you over these years, asking time and time again,
我感觉这些年来我只是在纠缠着你们，一次又一次地询问：
"Well, where are you going to be?" "I'm going to be in New York."
嗯，你们有什么计划？我要去纽约.
"Can you come? Can you come here? Can you do this? Can you take that? Can you ask for that? Can you come? Can we rap? Can we sing?"
 
你能来吗？你能来这吗？你能做这个不？你能拿那个不？你能问吗？你能来吗？我们能唱说唱音乐吗？我们能唱歌吗？
So thank you all so much.
所以，非常感谢你们所有人。
It really means the world to this initiative to have such powerful, respected and admired individuals speaking on behalf of this issue.
它真的意味着这个世界对这个倡议，存在有如此强大的受人尊敬和赞赏的个人，为这一问题发言。
So congratulations on the work that you've done, and we're going to keep working.
所以，祝贺你们所做成的工作，我们也将会继续前进。
And today, I especially want to recognize all these — extraordinary leadership team that was behind Reach Higher from day one.
今天我特别想要表彰，所有从第一天开始就为了实现更上一层楼目标的非凡的领导团队。
And this isn't on the script so they don't know this.
这个是没有在稿子上的，所以他们也不知道这个。
I want to take time to personally acknowledge a couple of people.
我想要借这个机会亲自答谢几个人。
Executive Director Eric Waldo. Where is Eric?
执行董事Eric Waldo。Eric在哪？
He's in the — you've got to step out.
他在那。你要上台来，上台来 Eric。
Eric is acting10 like he's a ham, but he likes the spotlight11.
 
Eric表现得好像他很差，其实他喜欢这个现场，
He's acting a little shy.
他只是有点害羞。
I want to recognize our Deputy Director, Stephanie Sprow.Stephanie.
我想要表彰我们的副主任，Stephanie Sprouse, Stephanie, Stephanie Sprouse。
And he's really not going to like this because he tries to pretend like he doesn't exist at all, but our Senior Advisor12, Greg Darnieder.
他真的不会这样的，因为他试图假装他根本不存在，但是我们的高级顾问Greg Darn不会。
There you go. Greg, Greg has been a leader in education his entire life. I've known him since I was a little organizer person.
对头。Greg, Greg在他的一生中，一直是教育上的领导者。从我还是个小小的活动组织者的时候，我就知道他了。
And it's just been just a joy to work with you all.
和你们一起工作真是太开心了。
These individuals, they are brilliant. They are creative.
他们都非常杰出，富有创造力，
They have worked miracles with hardly any staff or budget to speak of — which is how we roll in the first lady's Office.
在几乎没有任何人员或是财政预算的下他们创造了奇迹——就是我们如何运转第一夫人办公室。
And I am so proud and so, so grateful to you all for everything that you've done. So let's give them a round of applause.
我是如此自豪，非常感谢你们所做的一切事情，所以让我们一起为他们鼓掌。
And finally, I want to recognize all of you who are here in this audience.
最后，我要感谢在座的各位，
We have our educators, our leaders, our young people who have been with us since we launched Reach Higher back in 2014.
他们中有的是教育家、领者和年轻人——我们在2014年发起Reach Higher倡议时就一直跟我们在一起的。
Now, when we first came up with this idea, we had one clear goal in mind: We wanted to make higher education cool.
现在，当我们初步有这个想法时，我们就有一个明确的目标：我们希望让高等教育变得出色。
We wanted to change the conversation around what it means and what it takes to be a success in this country.
我们希望改变这个国家对成功的定义。
Because let's be honest, if we're always shining the spotlight on professional athletes or recording13 artists or Hollywood celebrities14,
因为坦诚地说，如果我们总是将镁光灯聚焦于职业运动员或唱片歌手或好莱坞明星，
if those are the only achievements we celebrate, then why would we ever think kids would see college as a priority?
如果我们只为这些成就欢呼庆祝，那我们凭什么认为孩子们会把上大学作为优先选项呢？
So we decided15 to flip16 the script and shine a big, bright spotlight on all things educational.
 
所以我们下决心开启新的篇章，并把一个大而明亮的聚光灯投向一切关乎教育的事业上。
For example, we made College Signing Day a national event.
例如，我们设立了一个全国性的活动——大学签名日。
We wanted to mimic17 all the drama and excitement traditionally reserved for those few amazing football and basketball players choosing their college and university teams.
我们想要模仿所有那些戏剧和令人兴奋的事——传统上只保留给那些少数出色的足球和篮球运动员选择他们的大学和大学球队。
We wanted to focus that same level of energy and attention on kids going to college because of their academic achievements.
我们想要将同等的精力和注意力集中在要读大学的孩子们身上——因为他们在学业上的成就。
Because as a nation, that's where the spotlight should also be,
因为作为一个国家，那也是聚光灯应该照亮的地方，
on kids who work hard in school and do the right thing when no one is watching, many beating daunting18 odds19.
那些在学校努力学习的，自觉去做正事的，许许多多不屈服命运的孩子的身上。
Next, we launched Better Make Room.
接下来我们发动了“更好的创造空间”运动，
It's a social media campaign to give young people the support and inspiration they need to actually complete higher education.
这是一个社交媒体运动，目的是给予年轻人他们所需要的支持和灵感，去真正地完成高等教育。
奥巴马夫妇And to really drive that message home, you may recall that I debuted20 my music career— rapping with Jay about getting some knowledge by going to college.
并切实地把这个消息带回家，你可能会想起，我的音乐生涯的首次登台表演——与Jay同台表演说唱音乐，这音乐的内容是：要通过上大学来获得的一些知识。
We are also very proud of all that this administration has done to make higher education more affordable21.
我们也为这个政府为了让高等教育更加负担得起所做的一切感到自豪。
We doubled investments in Pell grants and college tax credits.
我们在Pell奖学金和大学税收抵免上增加了一倍的投资。
We expanded income-based loan repayment22 options for tens of millions of students.
我们扩大到为数千万的学生提供以收入为基础的助学贷款的选择。
We made it easier to apply for financial aid.
我们让申请财政援助变得更加容易。
We created a College Scorecard to help students make good decisions about higher education.
我们创建了一个大学计分卡，来帮助同学们做出接受高等教育的明智决定。
And we provided new funding and support for school counselors.
同时我们也为学校的辅导员提供了新的资金和支持。
Altogether. Yes. Yeah, Thank you. You are welcome. Altogether, we made in this administration the largest investment in higher education since the G.I. Bill.
总而言之，是的，谢谢你，不用谢。总而言之，自G.I.法案以来，我们这届政府对高等教育的投资是最大的。
And today, the high school graduation rate is at a record high, and more young people than ever before are going to college.
 
今天，高中毕业率创历史新高，比以往任何时候都要多的年轻人要上大学。
And we know that school counselors like all of the folks standing3 with me on this stage have played a critical role in helping23 us get there. In fact, a recent study showed that students who met with a school counselor to talk about financial aid or college were three times more likely to attend college, and they were nearly seven times more likely to apply for financial aid.
我们知道，学校的辅导员，比如这些与我站在这个舞台上的所有人，在帮助我们达到这个记录中起了很关键的作用。实际上，最近的一项调查显示，与学校辅导员见面谈论有关财政援助和大学的学生，进入大学的可能性会增加三倍。同时他们申请经济援助的几率也将近七倍。
So our school counselors are truly among the heroes of the Reach Higher story. And that's why we created this event two years ago, because we thought that they should finally get some recognition. We wanted everyone to know about the difference that these phenomenal men and women have been making in the lives of our young people every day. And our 2017 School Counselor of the Year, Terri Tchorzynski, is a perfect example.
所以我们的学校辅导员是这个Reach Higher故事中真正的英雄。这也就是为什么两年前我们要创办这个活动，因为我们认为他们最终应该要得到一些认可。我们希望每个人都明白这些不同，这些了不起的人每天在我们的年轻人生活中所产生的。我们的2017年度校园辅导员Terry Trzcinski，就是一个完美的例子。
As you heard, Terri works at the Calhoun Area Career Center, a career and technical education school in Michigan. And here's what Terri's principal said about her in his letter of recommendation. He said, "Once she identifies a systemic need, she works tirelessly to address it."
 
正如所听到的，Terry在Calhoun地区的就业中心工作，这个中心在密歇根州的一个职业技术教育学校。Terry的校长在他的推荐信中是这样说她的。他说，一旦她确定了教育系统的需要，她就会不知疲倦地工作来满足它。
So when students at Terri's school reported feeling unprepared to apply for higher education, Terri sprang into action to create a school-wide, top-to-bottom college-readiness effort. Under Terri's leadership, more students than ever before attended workshops on resume writing, FAFSA completion — yes, I can now say FAFSA— and interview preparation. I can barely say it. They did career and personal — personality assessments24. They helped plan a special college week. And they organized a Military Day, hosting recruiters from all branches of our armed forces.
所以当Terry学校的学生说，感觉还没有准备好申请高等教育时，Terry马上就行动起来，创建一个全校性的、自上而下的准备上大学的尝试。在Terry的领导下，有比以前更多的学生参加简历写作研讨会和“联邦政府助学金免费申请”的完成，是的，现在我可以说，这是“联邦政府助学金免费申请”，以及做好面试准备。我几乎不能把它说出来。他们做了职业和个人人格评估，他们帮助计划了一个特别的大学周，他们还组织了一个军事日，来款待我们武装部队的所有分支的征兵人员。
And because of these efforts, today, 75 percent of Calhoun's seniors now complete key college application steps, and Terri's school has won state and national recognition.
由于这些努力，今天，有75%的Calhoun的高年级学生现在完成了关键的大学申请步骤，同时Terri的学校也得到了州和国家的认可。
And all of this is just one small part of what Terri does for her students each day. I can go on and on about all the time she spends one-on-one with students, helping them figure out their life path. Terri told us — as you heard, she told us about one of those students, so we reached out to Kyra. And here's what Kyra had to say in her own words. Kyra wrote that “Mrs. Tchorzynski has helped me grow to love myself. She helped me with my doubts and insecurities.” She said, my life has changed “for the better in all aspects.” Kyra said, “She held my hand through my hardest times.” She said, “Mrs. Tchorzynski is my lifesaver.” That's what Kyra said.
这些仅仅是Terri日工学生工作的一小部分，她花在一对一为学生探索人生方向的时间说也说不完。正如你们听到的，Terri向我们提起了她的一个学生Kyra。Kyra这样说，Tchorzynski女士让我学着爱自己，她帮助我解决我的怀疑和不安全，她说我的生活在所有方面已经向着更好迈进。Kyra说，她陪伴我走过最艰难的时光，Tchorzynski女士是我的人生的救星。这就是Kyra说的话。
And this is what each of you do every single day. You see the promise in each of your students. You believe in them even when they can't believe in themselves, and you work tirelessly to help them be who they were truly meant to be. And you do it all in the face of some overwhelming challenges — tight budgets, impossible student-counselor ratios — yeah, amen— endless demands on your time.
 
这就是你们每个人每天在做的事。你们看到了每个学生的潜力，你们相信着他们即使他们自己都失去信心。你们孜孜不倦地帮助他们成长为他们应该有的样子。你们克服着那么多的困难在做着这样的事情，不仅仅是紧缩的预算和难以置信的学生与顾问的比例，是的，是的，上帝保佑，还有大量的时间投入。
You all come in early, you stay late. You reach into your own pockets — and see, we've got the amen corner. You stick with students in their darkest moments, when they're most anxious and afraid. And if anyone is dealing25 with a college (high school) senior or junior, you know what this feels like.
你们起早贪黑，你们甚至要自掏腰包，看，有人表示同意，你们在这些学生最黑暗的时光里坚守着，在他们最焦虑和恐惧的时候，你们当中为大三大四的学生服务的应该最清楚了。
These men and women show them that those kids matter; that they have something to offer; that no matter where they're from or how much money their parents have, no matter what they look like or who they love or how they worship or what language they speak at home, they have a place in this country.
 
这些人让孩子们明白自己是被重视的，是能够为社会、为他人带来贡献的，不论出身，不论他们来自贫穷或是富贵，不论长相，不论他们爱着什么人，不论宗教信仰，不论他们的母语是什么，他们都是这个国家的一部分。
And as I end my time in the White House, I can think of no better message to send our young people in my last official remarks as first lady. So for all the young people in this room and those who are watching, know that this country belongs to you — to all of you, from every background and walk of life. If you or your parents are immigrants, know that you are part of a proud American tradition — the infusion26 of new cultures, talents and ideas, generation after generation, that has made us the greatest country on earth.
在白宫的最后这段日子，我想到了，作为第一夫人，我能够传达给年轻人的最好的讯息。所以，对在这个房间的所有年轻人，以及那些正在观看我演讲的人说，你们要知道，不论你们是什么背景，这个国家都属于你们。如果你或你的父母是移民，你要知道你们都是令人骄傲的美国文化的一部分——正是一代又一代，新的文化、知识和想法，让我们成为地球上最伟大的国家。
If your family doesn't have much money, I want you to remember that in this country, plenty of folks, including me and my husband — we started out with very little. But with a lot of hard work and a good education, anything is possible — even becoming President. That's what the American Dream is all about.
 
如果你的家庭并不富裕，我想让你记住，在这个国家有很多人，包括我和我的丈夫，我们开始的时候也没有多少钱。但是只要努力工作，接受良好的教育，任何事都有可能，你甚至能当上总统。这就是美国梦。
If you are a person of faith, know that religious diversity is a great American tradition, too. In fact, that's why people first came to this country — to worship freely. And whether you are Muslim, Christian27, Jewish, Hindu, Sikh — these religions are teaching our young people about justice, and compassion28, and honesty.
如果你是一个有信仰的人，要知道宗教的多样性也是一个伟大的美国传统。事实上，这就是为什么人们为了自由敬拜，第一次来这个国家。不管你是穆斯林，基督徒，犹太教徒，印度教徒，锡克教徒，这些宗教都教导我们的年轻人公正，热情和诚实。
So I want our young people to continue to learn and practice those values with pride. You see, our glorious diversity — our diversities of faiths and colors and creeds29 — that is not a threat to who we are, it makes us who we are. So the young people here and the young people out there: Do not ever let anyone make you feel like you don't matter, or like you don't have a place in our American story — because you do. And you have a right to be exactly who you are.
所以，我希望你们能够继续自豪地学习和提高这些美好的品德。你看，我们有着伟大的多样性——信仰的多样、肤色的多样、教义的多样——多样性并不会威胁、改变美国，相反，它造就了美国。在这里和在外边的年轻人，不要让任何人让你觉得你不重要，或者你在我们的美国的故事里没有地位。因为答案是，你有地位。你有权利做你想做的自己。
But I also want to be very clear: This right isn't just handed to you. No, this right has to be earned every single day. You cannot take your freedoms for granted. Just like generations who have come before you, you have to do your part to preserve and protect those freedoms. And that starts right now, when you're young.
但同时我要说清楚，这个权利并不是平白送给你的。你必须每天去努力来赢得这项权利，千万不能把自己的自由想成理所当然，同你的祖辈一样，你必须努力地作出自己的贡献去保护自由的权利，而这一切，就是从现在开始，从你年轻的时候开始。
Right now, you need to be preparing yourself to add your voice to our national conversation. You need to prepare yourself to be informed and engaged as a citizen, to serve and to lead, to stand up for our proud American values and to honor them in your daily lives. And that means getting the best education possible so you can think critically, so you can express yourself clearly, so you can get a good job and support yourself and your family, so you can be a positive force in your communities.
 
现在，你要做好准备在全国性大讨论中发表你的见解。你必须准备好以一个公民的标准去要求自己，为我们骄傲的美国价值观服务，领导并保护它，并以它指导你的日常生活，而这就意味着必须获取能力范围内最好的教育，让你学会批判性的思考，让你能清晰地表达自己的观点，让你能获取一个好工作，养活自己和家庭，让你能成为社区中的正能量。
And when you encounter obstacles — because I guarantee you, you will, and many of you already have — when you are struggling and you start thinking about giving up,
而当你遇到挫折的时候，我敢打包票你肯定会遇到挫折，你们当中的许多人已经遇到了挫折，当你困苦挣扎着，想要放弃的时候，
I want you to remember something that my husband and I have talked about since we first started this journey nearly a decade ago, something that has carried us through every moment in this White House and every moment of our lives, and that is the power of hope — the belief that something better is always possible if you're willing to work for it and fight for it.
我想要你记住一些我和我丈夫在10年前，一切刚刚开始的时候就在说的话，是它让我们挺过了在这白宫中所有的难关、我们生命中所有的难关。那就是希望的力量，相信只要自己愿意为之努力和奋斗，事情总会变得更好。
It is our fundamental belief in the power of hope that has allowed us to rise above the voices of doubt and division, of anger and fear that we have faced in our own lives and in the life of this country. Our hope that if we work hard enough and believe in ourselves, then we can be whatever we dream, regardless of the limitations that others may place on us. The hope that when people see us for who we truly are, maybe, just maybe they, too, will be inspired to rise to their best possible selves.
正是这份对“希望的力量”的坚信，带我们走过了生活中的质疑和异议，走过了愤怒和害怕。我们希望只要如果我们工作足够努力并且相信自己，那么我们就可以实现我们的所有梦想，尽管被人可能认为我们做不到。希望当别人看到我们勇敢做自己，也许，只是也许，会鼓励他们也尝试做自己，其最大化第实现自己的梦想。
That is the hope of students like Kyra who fight to discover their gifts and share them with the world. It's the hope of school counselors like Terri and all these folks up here who guide those students every step of the way, refusing to give up on even a single young person. Shoot, it's the hope of my — folks like my dad who got up every day to do his job at the city water plant; the hope that one day, his kids would go to college and have opportunities he never dreamed of.
这正是像Kyra这样的学生的希望，她用尽力量去挖掘自己的天赋，并与世界分享，这也是像Terri一样的辅导员和这里所有工作者的希望，他们一步步地引导学生，拒绝放弃哪怕是一个学生，这也是像我父亲这类人的希望，他每天早起去自来水厂工作，就是希望某一天，他的孩子能上大学，然后有机会获得他曾经梦想获得的一切。
That's the kind of hope that every single one of us — politicians, parents, preachers — all of us need to be providing for our young people.
这也是我们每一个人的希望——政治家、父母、牧师、我们所有人对年轻人的希望。
Because that is what moves this country forward every single day — our hope for the future and the hard work that hope inspires.
因为正是这份对于未来的希望和相应的努力奋斗，才推动了国家前进。
So that's my final message to young people as first lady. It is simple. I want our young people to know that they matter, that they belong. So don't be afraid —- you hear me, young people? Don't be afraid. Be focused. Be determined30. Be hopeful. Be empowered. Empower yourselves with a good education, then get out there and use that education to build a country worthy31 of your boundless32 promise. Lead by example with hope, never fear. And know that I will be with you, rooting for you and working to support you for the rest of my life.
这就是我作为第一夫人要送给年轻人的最后忠告，就这么简单。我想要我们的年轻人知道，他们很重要，他们属于这个国家。听见了吗？年轻人，不要害怕。要专注，要坚定，要满怀希望，要自强。用良好教育给予自己力量，当你进入社会后，能用这种教育来建设一个配得上你无限前途的国家。以身作则，带着希望，永不害怕。记住我永远与你同在，我会用我的余生来支持你。
And that is true I know for every person who are here — is here today, and for educators and advocates all across this nation who get up every day and work their hearts out to lift up our young people. And I am so grateful to all of you for your passion and your dedication and all the hard work on behalf of our next generation. And I can think of no better way to end my time as first lady than celebrating with all of you.
 
今天在这里的每一个人也会和我一样支持你，还有那些每天早起，竭尽全力去鼓舞年轻人的教育家、倡导者，我代表我们的下一代，对你们所有人的热情、贡献和勤奋表示感激，与你们一起庆祝是我能想到的告别第一夫人身份的最好方式。
So I want to close today by simply saying thank you. Thank you for everything you do for our kids and for our country. Being your first lady has been the greatest honor of my life, and I hope I've made you proud.
最后，我只想简单的说一句：谢谢你们！谢谢你们所有人为我们的孩子和这个国家做的一切，做你们的第一夫人是我人生中最大的荣誉，我希望我有让你们骄傲。


天天加速链接：https://gitee.com/lxk0301/jd_scripts/raw/master/jd_speed.js
更新时间：2020-12-25
活动入口：APP我的-更多工具-天天加速

脚本兼容: QuantumultX, Surge, Loon, JSBox, Node.js
每天4豆，再小的苍蝇也是肉
从 https://github.com/Zero-S1/JD_tools/blob/master/JD_speed.py 改写来的
建议3小时运行一次，打卡时间间隔是6小时
=================QuantumultX==============
[task_local]
#天天加速
8 0-23/3 * * * https://gitee.com/lxk0301/jd_scripts/raw/master/jd_speed.js, tag=京东天天加速, img-url=https://raw.githubusercontent.com/58xinian/icon/master/jdjs.png, enabled=true

============Loon================
[Script]
cron "8 0-23/3 * * *" script-path=https://gitee.com/lxk0301/jd_scripts/raw/master/jd_speed.js,tag=京东天天加速

===========Surge============
天天加速 = type=cron,cronexp="8 0-23/3 * * *",wake-system=1,timeout=3600,script-path=https://gitee.com/lxk0301/jd_scripts/raw/master/jd_speed.js

==============小火箭=============
天天加速 = type=cron,script-path=https://gitee.com/lxk0301/jd_scripts/raw/master/jd_speed.js, cronexpr="11 0-23/3 * * *", timeout=3600, enable=true
*/

const $ = new Env('✈️天天加速');
const notify = $.isNode() ? require('./sendNotify') : '';
//Node.js用户请在jdCookie.js处填写京东ck;
const jdCookieNode = $.isNode() ? require('./jdCookie.js') : '';

//IOS等用户直接用NobyDa的jd cookie
let cookiesArr = [], cookie = '';
if ($.isNode()) {
  Object.keys(jdCookieNode).forEach((item) => {
    cookiesArr.push(jdCookieNode[item])
  })
  if (process.env.JD_DEBUG && process.env.JD_DEBUG === 'false') console.log = () => {};
} else {
  let cookiesData = $.getdata('CookiesJD') || "[]";
  cookiesData = jsonParse(cookiesData);
  cookiesArr = cookiesData.map(item => item.cookie);
  cookiesArr.reverse();
  cookiesArr.push(...[$.getdata('CookieJD2'), $.getdata('CookieJD')]);
  cookiesArr.reverse();
  cookiesArr = cookiesArr.filter(item => item !== "" && item !== null && item !== undefined);
}
let jdNotify = true;//是否开启静默运行。默认true开启
let message = '', subTitle = '';
const JD_API_HOST = 'https://api.m.jd.com/'

!(async () => {
  if (!cookiesArr[0]) {
    $.msg($.name, '【提示】请先获取京东账号一cookie\n直接使用NobyDa的京东签到获取', 'https://bean.m.jd.com/bean/signIndex.action', {"open-url": "https://bean.m.jd.com/bean/signIndex.action"});
    return;
  }
  for (let i = 0; i < cookiesArr.length; i++) {
    if (cookiesArr[i]) {
      cookie = cookiesArr[i];
      $.UserName = decodeURIComponent(cookie.match(/pt_pin=(.+?);/) && cookie.match(/pt_pin=(.+?);/)[1])
      $.index = i + 1;
      $.isLogin = true;
      $.nickName = '';
      await TotalBean();
      console.log(`\n开始【京东账号${$.index}】${$.nickName || $.UserName}\n`);
      if (!$.isLogin) {
        $.msg($.name, `【提示】cookie已失效`, `京东账号${$.index} ${$.nickName || $.UserName}\n请重新登录获取\nhttps://bean.m.jd.com/bean/signIndex.action`, {"open-url": "https://bean.m.jd.com/bean/signIndex.action"});

        if ($.isNode()) {
          await notify.sendNotify(`${$.name}cookie已失效 - ${$.UserName}`, `京东账号${$.index} ${$.UserName}\n请重新登录获取cookie`);
        }
        continue
      }
      message = '';
      subTitle = '';
      await jDSpeedUp();
      await getMemBerList();
      await showMsg();
    }
  }
})()
    .catch((e) => {
      $.log('', `❌ ${$.name}, 失败! 原因: ${e}!`, '')
    })
    .finally(() => {
      $.done();
    })
function showMsg() {
  jdNotify = $.getdata('jdSpeedNotify') ? $.getdata('jdSpeedNotify') : jdNotify;
  if (!jdNotify || jdNotify === 'false') {
    $.msg($.name, subTitle, `【京东账号${$.index}】${$.nickName}\n` + message);
  } else {
    $.log(`\n${message}\n`);
  }
}
function jDSpeedUp(sourceId) {
  return new Promise((resolve) => {
    let body = {"source": "game"};
    if (sourceId) {
      body.source_id = sourceId
    }
    const url = {
      // url: JD_API_HOST + '?appid=memberTaskCenter&functionId=flyTask_' + (sourceId ? 'start&body=%7B%22source%22%3A%22game%22%2C%22source_id%22%3A' + sourceId + '%7D' : 'state&body=%7B%22source%22%3A%22game%22%7D'),
      url: `${JD_API_HOST}?appid=memberTaskCenter&functionId=flyTask_${sourceId ? 'start' : 'state'}&body=${escape(JSON.stringify(body))}`,
      headers: {
        'Cookie': cookie,
        'Host': 'api.m.jd.com',
        'Accept': '*/*',
        'Connection': 'keep-alive',
        'User-Agent': $.isNode() ? (process.env.JD_USER_AGENT ? process.env.JD_USER_AGENT : (require('./USER_AGENTS').USER_AGENT)) : ($.getdata('JDUA') ? $.getdata('JDUA') : "jdapp;iPhone;9.2.2;14.2;%E4%BA%AC%E4%B8%9C/9.2.2 CFNetwork/1206 Darwin/20.1.0"),
        'Accept-Language': 'zh-cn',
        'Referer': 'https://h5.m.jd.com/babelDiy/Zeus/6yCQo2eDJPbyPXrC3eMCtMWZ9ey/index.html?lng=116.845095&lat=39.957701&sid=ea687233c5e7d226b30940ed7382c5cw&un_area=5_274_49707_49973',
        'Accept-Encoding': 'gzip, deflate, br'
      }
    };
    $.get(url, async (err, resp, data) => {
      try {
        if (err) {
          console.log('京东天天-加速: 签到接口请求失败 ‼️‼️');
          console.log(`${JSON.stringify(err)}`)
        } else {
          if (data) {
            let res = JSON.parse(data);
            if (!sourceId) {
              console.log(`\n天天加速任务进行中`);
            } else {
              console.log("\n" + "天天加速-开始本次任务 ");
            }
            if (res.code === 0 && res.success) {
              subTitle = `【奖励】${res.data.beans_num}京豆`;
              if (res.data.task_status === 0) {
                const taskID = res.data.source_id;
                await jDSpeedUp(taskID);
              } else if (res.data.task_status === 1) {
                const EndTime = res.data.end_time ? res.data.end_time : ""
                console.log("\n天天加速进行中-结束时间: \n" + EndTime);
                const space = await spaceEventList()
                const HandleEvent = await spaceEventHandleEvent(space)
                const step1 = await energyPropList();//检查燃料
                const step2 = await receiveEnergyProp(step1);//领取可用的燃料
                const step3 = await energyPropUsaleList(step2)
                const step4 = await useEnergy(step3)
                if (step4) {
                  await jDSpeedUp(null);
                } else {
                  message += `【空间站】 ${res.data.destination}\n`;
                  message += `【结束时间】 ${res.data.end_time}\n`;
                  message += `【进度】 ${((res.data['done_distance'] / res.data.distance) * 100).toFixed(2)}%\n`;
                }
              } else if (res.data.task_status === 2) {
                if (data.match(/\"beans_num\":\d+/)) {
                  //message += "【上轮奖励】成功领取" + data.match(/\"beans_num\":(\d+)/)[1] + "京豆 🐶";
                  if (!jdNotify || jdNotify === 'false') {
                    $.msg($.name, '', `【京东账号${$.index}】${$.nickName}\n` + "【上轮太空旅行】成功领取" + data.match(/\"beans_num\":(\d+)/)[1] + "京豆 🐶");
                  }
                } else {
                  console.log("京东天天-加速: 成功, 明细: 无京豆 🐶")
                }
                console.log("\n天天加速-领取上次奖励成功")
                await jDSpeedUp(null);
              } else {
                console.log("\n" + "天天加速-判断状态码失败")
              }
            }
          } else {
            console.log(`京豆api返回数据为空，请检查自身原因`)
          }
        }
      } catch (e) {
        // $.msg("京东天天-加速" + e.name + "‼️", JSON.stringify(e), e.message)
        $.logErr(e, resp);
      } finally {
        resolve()
      }
    })
  })
}

// 检查太空特殊事件
function spaceEventList() {
  return new Promise((resolve) => {
    let spaceEvents = [];
    const body = { "source": "game"};
    const spaceEventUrl = {
      url: `${JD_API_HOST}?appid=memberTaskCenter&functionId=spaceEvent_list&body=${escape(JSON.stringify(body))}`,
      headers: {
        Referer: 'https://h5.m.jd.com/babelDiy/Zeus/6yCQo2eDJPbyPXrC3eMCtMWZ9ey/index.html',
        Cookie: cookie
      }
    }
    $.get(spaceEventUrl, async (err, resp, data) => {
      try {
        if (err) {
          console.log("\n京东天天-加速: 查询太空特殊事件请求失败 ‼️‼️")
          console.log(`${JSON.stringify(err)}`)
        } else {
          if (data) {
            const cc = JSON.parse(data);
            if (cc.message === "success" && cc.data.length > 0) {
              for (let item of cc.data) {
                if (item.status === 1) {
                  for (let j of item.options) {
                    if (j.type === 1) {
                      spaceEvents.push({
                        "id": item.id,
                        "value": j.value
                      })
                    }
                  }
                }
              }
              if (spaceEvents && spaceEvents.length > 0) {
                console.log("\n天天加速-查询到" + spaceEvents.length + "个太空特殊事件")
              } else {
                console.log("\n天天加速-暂无太空特殊事件")
              }
            } else {
              console.log("\n天天加速-查询无太空特殊事件")
            }
          } else {
            console.log(`京豆api返回数据为空，请检查自身原因`)
          }
        }
      } catch (e) {
        // $.msg("天天加速-查询太空特殊事件" + e.name + "‼️", JSON.stringify(e), e.message)
        $.logErr(e, resp)
      } finally {
        resolve(spaceEvents)
      }
    })
  })
}

//处理太空特殊事件
function spaceEventHandleEvent(spaceEventList) {
  return new Promise((resolve) => {
    if (spaceEventList && spaceEventList.length > 0) {
      let spaceEventCount = 0, spaceNumTask = 0;
      for (let item of spaceEventList) {
        let body = {
          "source":"game",
          "eventId": item.id,
          "option": item.value
        }
        const spaceHandleUrl = {
          url: `${JD_API_HOST}?appid=memberTaskCenter&functionId=spaceEvent_handleEvent&body=${escape(JSON.stringify(body))}`,
          headers: {
            Referer: 'https://h5.m.jd.com/babelDiy/Zeus/6yCQo2eDJPbyPXrC3eMCtMWZ9ey/index.html',
            Cookie: cookie
          }
        }
        spaceEventCount += 1
        $.get(spaceHandleUrl, (err, resp, data) => {
          try {
            if (err) {
              console.log("\n京东天天-加速: 处理太空特殊事件请求失败 ‼️‼️")
              console.log(`${JSON.stringify(err)}`)
            } else {
              if (data) {
                const cc = JSON.parse(data);
                // console.log(`处理特殊事件的结果：：${JSON.stringify(cc)}`);
                console.log("\n天天加速-尝试处理第" + spaceEventCount + "个太空特殊事件")
                if (cc.message === "success" && cc.success) {
                  spaceNumTask += 1;
                } else {
                  console.log("\n天天加速-处理太空特殊事件失败")
                }
              } else {
                console.log(`京豆api返回数据为空，请检查自身原因`)
              }
            }
          } catch (e) {
            // $.msg("天天加速-查询处理太空特殊事件" + e.name + "‼️", JSON.stringify(e), e.message)
            $.logErr(e, resp)
          } finally {
            if (spaceEventList.length === spaceNumTask) {
              console.log("\n天天加速-已成功处理" + spaceNumTask + "个太空特殊事件")
              resolve()
            }
          }
        })
      }
    } else {
      resolve()
    }
  })
}

//检查燃料
function energyPropList() {
  return new Promise((resolve) => {
    let TaskID = "";
    const body = { "source": "game"};
    const QueryUrl = {
      // url: JD_API_HOST + '?appid=memberTaskCenter&functionId=energyProp_list&body=%7B%22source%22%3A%22game%22%7D',
      url: `${JD_API_HOST}?appid=memberTaskCenter&functionId=energyProp_list&body=${escape(JSON.stringify(body))}`,
      headers: {
        Referer: 'https://h5.m.jd.com/babelDiy/Zeus/6yCQo2eDJPbyPXrC3eMCtMWZ9ey/index.html',
        Cookie: cookie
      }
    };
    $.get(QueryUrl, async (err, resp, data) => {
      try {
        if (err) {
          console.log("\n京东天天-加速: 查询道具请求失败 ‼️‼️")
          console.log(`${JSON.stringify(err)}`)
        } else {
          if (data) {
            const cc = JSON.parse(data)
            if (cc.message === "success" && cc.data.length > 0) {
              for (let i = 0; i < cc.data.length; i++) {
                if (cc.data[i].thaw_time === 0) {
                  TaskID += cc.data[i].id + ",";
                }
              }
              if (TaskID.length > 0) {
                TaskID = TaskID.substr(0, TaskID.length - 1).split(",")
                console.log("\n天天加速-查询到" + TaskID.length + "个可用燃料")
              } else {
                console.log("\n天天加速-检查燃料-暂无可用燃料")
              }
            } else {
              console.log("\n天天加速-查询无燃料")
            }
          } else {
            console.log(`京豆api返回数据为空，请检查自身原因`)
          }
        }
      } catch (eor) {
        // $.msg("天天加速-查询燃料" + eor.name + "‼️", JSON.stringify(eor), eor.message)
        $.logErr(e, resp)
      } finally {
        resolve(TaskID)
      }
    })
  })
}

//领取可用的燃料
function receiveEnergyProp(CID) {
  return new Promise((resolve) => {
    var NumTask = 0;
    if (CID) {
      let count = 0
      for (let i = 0; i < CID.length; i++) {
        let body = {
          "source":"game",
          "energy_id": CID[i]
        }
        const TUrl = {
          // url: JD_API_HOST + '?appid=memberTaskCenter&functionId=energyProp_gain&body=%7B%22source%22%3A%22game%22%2C%22energy_id%22%3A' + CID[i] + '%7D',
          url: `${JD_API_HOST}?appid=memberTaskCenter&functionId=energyProp_gain&body=${escape(JSON.stringify(body))}`,
          headers: {
            Referer: 'https://h5.m.jd.com/babelDiy/Zeus/6yCQo2eDJPbyPXrC3eMCtMWZ9ey/index.html',
            Cookie: cookie
          }
        };
        count += 1
        $.get(TUrl, (error, response, data) => {
          try {
            if (error) {
              console.log("\n天天加速-领取道具请求失败 ‼️‼️")
              console.log(`${JSON.stringify(error)}`)
            } else {
              if (data) {
                const cc = JSON.parse(data)
                console.log("\n天天加速-尝试领取第" + count + "个可用燃料")
                if (cc.message === 'success') {
                  NumTask += 1
                }
              } else {
                console.log(`京豆api返回数据为空，请检查自身原因`)
              }
            }
          } catch (eor) {
            // $.msg("天天加速-领取可用燃料" + eor.name + "‼️", JSON.stringify(eor), eor.message)
            $.logErr(e, resp)
          } finally {
            if (CID.length === count) {
              console.log("\n天天加速-已成功领取" + NumTask + "个可用燃料")
              resolve(NumTask)
            }
          }
        })
      }
    } else {
      resolve(NumTask)
    }
  })
}

//检查剩余燃料
function energyPropUsaleList(EID) {
  return new Promise((resolve) => {
    let TaskCID = '';
    const body = { "source": "game"};
    const EUrl = {
      // url: JD_API_HOST + '?appid=memberTaskCenter&functionId=energyProp_usalbeList&body=%7B%22source%22%3A%22game%22%7D',
      url: `${JD_API_HOST}?appid=memberTaskCenter&functionId=energyProp_usalbeList&body=${escape(JSON.stringify(body))}`,
      headers: {
        Referer: 'https://h5.m.jd.com/babelDiy/Zeus/6yCQo2eDJPbyPXrC3eMCtMWZ9ey/index.html',
        Cookie: cookie
      }
    };
    $.get(EUrl, (error, response, data) => {
      try {
        if (error) {
          console.log("\n天天加速-查询道具ID请求失败 ‼️‼️")
          console.log(`${JSON.stringify(error)}`)
        } else {
          if (data) {
            const cc = JSON.parse(data);
            if (cc.code === 0 && cc.success) {
              if (cc.data.length > 0) {
                for (let i = 0; i < cc.data.length; i++) {
                  if (cc.data[i].id) {
                    TaskCID += cc.data[i].id + ",";
                  }
                }
                if (TaskCID.length > 0) {
                  TaskCID = TaskCID.substr(0, TaskCID.length - 1).split(",")
                  console.log("\n天天加速-查询成功" + TaskCID.length + "个燃料ID")
                } else {
                  console.log("\n天天加速-暂无有效燃料ID")
                }
              } else {
                console.log("\n天天加速-查询无燃料ID")
              }
            }
          } else {
            console.log(`京豆api返回数据为空，请检查自身原因`)
          }
        }
      } catch (eor) {
        // $.msg("天天加速-燃料ID" + eor.name + "‼️", JSON.stringify(eor), eor.message)
        $.logErr(e, resp)
      } finally {
        resolve(TaskCID)
      }
    })
    // if (EID) {
    //
    // } else {
    //   resolve(TaskCID)
    // }
  })
}

//使用能源
function useEnergy(PropID) {
  return new Promise((resolve) => {
    var PropNumTask = 0;
    let PropCount = 0
    if (PropID) {
      for (let i = 0; i < PropID.length; i++) {
        let body = {
          "source":"game",
          "energy_id": PropID[i]
        }
        const PropUrl = {
          // url: JD_API_HOST + '?appid=memberTaskCenter&functionId=energyProp_use&body=%7B%22source%22%3A%22game%22%2C%22energy_id%22%3A%22' + PropID[i] + '%22%7D',
          url: `${JD_API_HOST}?appid=memberTaskCenter&functionId=energyProp_use&body=${escape(JSON.stringify(body))}`,
          headers: {
            Referer: 'https://h5.m.jd.com/babelDiy/Zeus/6yCQo2eDJPbyPXrC3eMCtMWZ9ey/index.html',
            Cookie: cookie
          }
        };
        PropCount += 1;
        $.get(PropUrl, (error, response, data) => {
          try {
            if (error) {
              console.log("\n天天加速-使用燃料请求失败 ‼️‼️")
              console.log(`${JSON.stringify(error)}`)
            } else {
              if (data) {
                const cc = JSON.parse(data);
                console.log("\n天天加速-尝试使用第" + PropCount + "个燃料")
                if (cc.message === 'success' && cc.success === true) {
                  PropNumTask += 1
                }
              } else {
                console.log(`京豆api返回数据为空，请检查自身原因`)
              }
            }
          } catch (eor) {
            // $.msg("天天加速-使用燃料" + eor.name + "‼️", JSON.stringify(eor), eor.message)
            $.logErr(e, resp)
          } finally {
            if (PropID.length === PropCount) {
              console.log("\n天天加速-已成功使用" + PropNumTask + "个燃料")
              resolve(PropNumTask)
            }
          }
        })
      }
    } else {
      resolve(PropNumTask)
    }
  })
}
//虫洞
function getMemBerList() {
  return new Promise((resolve) => {
    const body = { "source": "game", "status": 0};
    const spaceEventUrl = {
      url: `${JD_API_HOST}?appid=memberTaskCenter&functionId=member_list&body=${escape(JSON.stringify(body))}&_t=${Date.now()}`,
      headers: {
        Referer: 'https://h5.m.jd.com/babelDiy/Zeus/6yCQo2eDJPbyPXrC3eMCtMWZ9ey/index.html',
        Cookie: cookie,
        "User-Agent": $.isNode() ? (process.env.JD_USER_AGENT ? process.env.JD_USER_AGENT : (require('./USER_AGENTS').USER_AGENT)) : ($.getdata('JDUA') ? $.getdata('JDUA') : "jdapp;iPhone;9.2.2;14.2;%E4%BA%AC%E4%B8%9C/9.2.2 CFNetwork/1206 Darwin/20.1.0")
      }
    }
    $.get(spaceEventUrl, async (err, resp, data) => {
      try {
        if (err) {
          console.log(`${$.name} API请求失败，请检查网路重试`)
          console.log(`${JSON.stringify(err)}`)
        } else {
          if (safeGet(data)) {
            data = JSON.parse(data);
            if (data && data.success) {
              for (let item of data.data) {
                if (item['taskStatus'] === 0) {
                  $.log(`去领取【${item['title']}】任务\n`)
                  await getMemBerGetTask(item['sourceId']);
                }
              }
              $.getRewardBeans = 0;
              console.log(`\n检查是否可领虫洞京豆奖励`)
              $.memBerList = data.data.filter(item => item['taskStatus'] === 2);
              if ($.memBerList && $.memBerList.length > 0) {
                for (let uuids of $.memBerList) {
                  await getReward(uuids['uuid']);
                }
                if ($.getRewardBeans > 0) {
                  $.msg(`${$.name}`, '', `京东账号${$.index}  ${$.nickName}\n虫洞任务：获得${$.getRewardBeans}京豆`);
                  if ($.isNode()) await notify.sendNotify(`${$.name} - 账号${$.index} - ${$.nickName}`, `京东账号${$.index}  ${$.nickName}\n虫洞任务：获得${$.getRewardBeans}京豆`)
                }
              } else {
                console.log(`暂无可领取的虫洞京豆奖励`)
              }
            }
          }
        }
      } catch (e) {
        // $.msg("天天加速-查询太空特殊事件" + e.name + "‼️", JSON.stringify(e), e.message)
        $.logErr(e, resp)
      } finally {
        resolve()
      }
    })
  })
}
//领取虫洞任务API
function getMemBerGetTask(sourceId) {
  return new Promise((resolve) => {
    const body = { "source": "game", sourceId};
    const options = {
      url: `${JD_API_HOST}?appid=memberTaskCenter&functionId=member_getTask&body=${escape(JSON.stringify(body))}&_t=${Date.now()}`,
      headers: {
        Referer: 'https://h5.m.jd.com/babelDiy/Zeus/6yCQo2eDJPbyPXrC3eMCtMWZ9ey/index.html',
        Cookie: cookie,
        "User-Agent": $.isNode() ? (process.env.JD_USER_AGENT ? process.env.JD_USER_AGENT : (require('./USER_AGENTS').USER_AGENT)) : ($.getdata('JDUA') ? $.getdata('JDUA') : "jdapp;iPhone;9.2.2;14.2;%E4%BA%AC%E4%B8%9C/9.2.2 CFNetwork/1206 Darwin/20.1.0")
      }
    }
    $.get(options, async (err, resp, data) => {
      try {
        if (err) {
          console.log(`${$.name} API请求失败，请检查网路重试`)
          console.log(`${JSON.stringify(err)}`)
        } else {
          if (safeGet(data)) {
            data = JSON.parse(data);
            if (data && data.success) {
              // $.getRewardBeans += data.data.beans;
            }
          }
        }
      } catch (e) {
        $.logErr(e, resp)
      } finally {
        resolve()
      }
    })
  })
}
function getReward(uuid) {
  return new Promise((resolve) => {
    const body = { "source": "game", uuid};
    const options = {
      url: `${JD_API_HOST}?appid=memberTaskCenter&functionId=member_getReward&body=${escape(JSON.stringify(body))}&_t=${Date.now()}`,
      headers: {
        Referer: 'https://h5.m.jd.com/babelDiy/Zeus/6yCQo2eDJPbyPXrC3eMCtMWZ9ey/index.html',
        Cookie: cookie,
        "User-Agent": $.isNode() ? (process.env.JD_USER_AGENT ? process.env.JD_USER_AGENT : (require('./USER_AGENTS').USER_AGENT)) : ($.getdata('JDUA') ? $.getdata('JDUA') : "jdapp;iPhone;9.2.2;14.2;%E4%BA%AC%E4%B8%9C/9.2.2 CFNetwork/1206 Darwin/20.1.0")
      }
    }
    $.get(options, async (err, resp, data) => {
      try {
        if (err) {
          console.log(`${$.name} API请求失败，请检查网路重试`)
          console.log(`${JSON.stringify(err)}`)
        } else {
          if (safeGet(data)) {
            data = JSON.parse(data);
            if (data && data.success) {
              $.getRewardBeans += data.data.beans;
            }
          }
        }
      } catch (e) {
        $.logErr(e, resp)
      } finally {
        resolve()
      }
    })
  })
}
function TotalBean() {
  return new Promise(async resolve => {
    const options = {
      "url": `https://wq.jd.com/user/info/QueryJDUserInfo?sceneval=2`,
      "headers": {
        "Accept": "application/json,text/plain, */*",
        "Content-Type": "application/x-www-form-urlencoded",
        "Accept-Encoding": "gzip, deflate, br",
        "Accept-Language": "zh-cn",
        "Connection": "keep-alive",
        "Cookie": cookie,
        "Referer": "https://wqs.jd.com/my/jingdou/my.shtml?sceneval=2",
        "User-Agent": $.isNode() ? (process.env.JD_USER_AGENT ? process.env.JD_USER_AGENT : (require('./USER_AGENTS').USER_AGENT)) : ($.getdata('JDUA') ? $.getdata('JDUA') : "jdapp;iPhone;9.2.2;14.2;%E4%BA%AC%E4%B8%9C/9.2.2 CFNetwork/1206 Darwin/20.1.0")
      }
    }
    $.post(options, (err, resp, data) => {
      try {
        if (err) {
          console.log(`${JSON.stringify(err)}`)
          console.log(`${$.name} API请求失败，请检查网路重试`)
        } else {
          if (data) {
            data = JSON.parse(data);
            if (data['retcode'] === 13) {
              $.isLogin = false; //cookie过期
              return
            }
            $.nickName = data['base'].nickname;
          } else {
            console.log(`京东服务器返回空数据`)
          }
        }
      } catch (e) {
        $.logErr(e, resp)
      } finally {
        resolve();
      }
    })
  })
}
function jsonParse(str) {
  if (typeof str == "string") {
    try {
      return JSON.parse(str);
    } catch (e) {
      console.log(e);
      $.msg($.name, '', '请勿随意在BoxJs输入框修改内容\n建议通过脚本去获取cookie')
      return [];
    }
  }
}
function safeGet(data) {
  try {
    if (typeof JSON.parse(data) == "object") {
      return true;
    }
  } catch (e) {
    console.log(e);
    console.log(`京东服务器访问数据为空，请检查自身设备网络情况`);
    return false;
  }
}
// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
